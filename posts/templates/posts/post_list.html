<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>All Posts</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body>

    <!-- Top Corner Links for Login, Register, and Create Post -->
    <div style="position: absolute; top: 10px; left: 10px;">
        {% if user.is_authenticated %}
            <a href="{% url 'create_post' %}" class="btn btn-primary">Create Post</a>
        {% endif %}
    </div>
    <div style="position: absolute; top: 10px; right: 10px;">
        {% if user.is_authenticated %}
            <p>Welcome, {{ user.username }}!</p>
            <form action="{% url 'logout' %}" method="post" style="display:inline;">
                {% csrf_token %}
                <button type="submit" class="btn btn-danger">Log Out</button>
            </form>
        {% else %}
            <a href="{% url 'login' %}" class="btn btn-secondary">Login</a>
            <a href="{% url 'register' %}" class="btn btn-secondary">Register</a>
        {% endif %}
    </div>

    <!-- Main Content: Display All Posts -->
    <div class="container mt-5">
        <h1>All Posts</h1>
        <div class="post-list">
            {% for post in posts %}
                <div class="post mb-4">
                    <h2><a href="{% url 'post_detail' post.id %}">{{ post.title }}</a></h2>
                    <p>{{ post.description }}</p>
                    
                    {% if post.image %}
                        <img src="{{ post.image.url }}" alt="Image for {{ post.title }}" class="img-fluid" style="max-width: 100%; height: auto;">
                    {% endif %}
                    
                    <!-- Display Properties -->
                    <ul>
                        <li>Property 1: {{ post.property1 }}</li>
                        <li>Property 2: {{ post.property2 }}</li>
                        <li>Property 3: {{ post.property3 }}</li>
                        <li>Property 4: {{ post.property4 }}</li>
                        <li>Property 5: {{ post.property5 }}</li>
                    </ul>

                    <!-- Display Comments -->
                    <h5>Comments:</h5>
                    {% for comment in post.comments.all %}
                        <p><strong>{{ comment.author }}:</strong> {{ comment.text }}</p>
                    {% empty %}
                        <p>No comments yet.</p>
                    {% endfor %}

                    <!-- Comment Form (only for logged-in users) -->
                    {% if user.is_authenticated %}
                        <form action="{% url 'post_list' %}" method="post">
                            {% csrf_token %}
                            <input type="hidden" name="post_id" value="{{ post.id }}">
                            {{ form.as_p }}
                            <button type="submit" class="btn btn-primary">Add Comment</button>
                        </form>
                    {% else %}
                        <p><a href="{% url 'login' %}">Log in</a> to add a comment.</p>
                    {% endif %}
                </div>
            {% endfor %}
        </div>
    </div>
</body>
</html>
